<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: manageables/Device.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: manageables/Device.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * @module manage/manageables/Device
 */

var util = require('util');
var Manageable = process.requireManage('app/server/manageables/Manageable.js');

/**
 * Defines a Device.
 *
 * A Device is a Manageable structure holding information about a device.
 *
 * @class Device
 * @extends module:manage/manageables/Manageable~Manageable
 * @constructor
 * @param {Object} device A device description object
 * @param {String} device.id The device id
 * @param {String} [device.name] The device name
 * @param {String} [device.state] The device state
 * @param {Array} [device.history] The list of history events related to the device
 * @param {Array} [device.schedules] The list of device's schedules
 * @param {Object} [device.storage] The device's storage information
 * @param {Object} [device.inputs] The device's inputs information
 * @param {Array} [device.presets] The list of device's presets
 * @param {String} [device.group] The device's group
 * @param {String} [device.ip] The device's ip
 * @param {String} [device.url] The device's web interface url
 */
function Device(device) {
  Device.super_.call(this, device);

  Object.defineProperties(this,

    /** @lends module:manage/manageables/Device~Device */
    {

      /**
       * The device's type.
       *
       * @type {String}
       * @default Device.TYPE
       * @instance
       * @readonly
       */
      type: {value: Device.TYPE, enumerable: true},

      /**
       * The device's state.
       *
       * @type {String}
       * @instance
       */
      state: {value: device.state, writable: true, enumerable: true},

      /**
       * The device's storage information.
       *
       * @type {Object}
       * @instance
       */
      storage: {value: device.storage, writable: true, enumerable: true},

      /**
       * The device's inputs information.
       *
       * @type {Object}
       * @instance
       */
      inputs: {value: device.inputs, writable: true, enumerable: true},

      /**
       * The device's presets.
       *
       * @type {Array}
       * @instance
       */
      presets: {value: device.presets, writable: true, enumerable: true},

      /**
       * The device's group.
       *
       * @type {String}
       * @instance
       */
      group: {value: device.group, writable: true, enumerable: true},

      /**
       * The device's ip address.
       *
       * @type {String}
       * @instance
       */
      ip: {value: device.ip, writable: true, enumerable: true},

      /**
       * The device's web interface url.
       *
       * @type {String}
       * @instance
       */
      url: {value: device.url, writable: true, enumerable: true},

      /**
       * The device's status.
       *
       * @type {String}
       * @instance
       */
      status: {value: device.status, writable: true, enumerable: true}

    }

  );

  this.setInputs();
  this.setPresets();
}

module.exports = Device;
util.inherits(Device, Manageable);

/**
 * Device type.
 *
 * @memberof module:manage/manageables/Device~Device
 * @member {String} TYPE
 * @private
 * @const
 * @default 'device'
 */
Object.defineProperty(Device, 'TYPE', {value: 'device'});

/**
 * Sets device's storage information.
 *
 * @param {Number} free Number of free Bytes
 * @param {Number} used Number of used Bytes
 */
Device.prototype.setStorage = function(free, used) {
  free = parseInt(free);
  used = parseInt(used);

  if (free || used) {
    var bytesToGbytes = Math.pow(1024, 3);
    this.storage = {
      free: free / bytesToGbytes,
      used: used / bytesToGbytes,
      total: (free + used) / bytesToGbytes,
      percent: (used / (free + used)) * 100
    };
  }
};

/**
 * Sets device's inputs information.
 *
 * @param {Object} [camera Information] about the video camera connected to the device
 * @param {Object} [camera.timings] Information about video camera's configuration
 * @param {Boolean} [camera.timings.supported] true if the connected video camera is supported, false otherwise
 * @param {Object} [slides Information] about the slides connected to the device
 * @param {Object} [slides.timings] Information about the slides' input configuration
 * @param {Boolean} [slides.timings.supported] true if the connected slides' input is supported, false otherwise
 */
Device.prototype.setInputs = function(camera, slides) {
  this.inputs = {
    camera: 'disconnected',
    desktop: 'disconnected'
  };

  if (camera &amp;&amp; camera.timings)
    this.inputs.camera = (!camera.timings.supported) ? 'ko' : 'ok';

  if (slides &amp;&amp; slides.timings)
    this.inputs.desktop = (!slides.timings.supported) ? 'ko' : 'ok';
};

/**
 * Sets device's presets.
 *
 * @param {Object} [presets] The list of presets referenced by ids
 */
Device.prototype.setPresets = function(presets) {
  this.presets = [];

  for (var id in presets) {
    presets[id].id = id;
    this.presets.push(presets[id]);
  }
};

/**
 * Disconnects the device which removes all volatile information.
 */
Device.prototype.disconnect = function() {
  this.presets = null;
  this.inputs = null;
  this.storage = null;
};

/**
 * Checks if a schedule is not in collision with schedules of a group.
 *
 * Device schedule should not be in collision with group's schedules.
 *
 * @param {Object} schedule The schedule description object
 * @param {Object} [group] The group to test the schedule with
 * @return {Boolean} true if the schedule is not in collision with other schedules
 * false otherwise
 */
Device.prototype.isValidSchedule = function(schedule, group) {
  if (!Device.super_.prototype.isValidSchedule.call(this, schedule))
    return false;

  if (group) {

    // Validates that the schedule is not in conflict with one of the
    // schedules in device's group
    for (var i = 0; i &lt; group.schedules.length; i++) {
      if (this.checkSchedulesConflict(group.schedules[i], schedule))
        return false;
    }

  }

  return true;
};

/**
 * Checks if there are collisions between device's schedules and group's schedules.
 *
 * @param {Object} group The group
 * @return {Boolean} true if there is at least one collision, false otherwise
 */
Device.prototype.isGroupSchedulesCollision = function(group) {
  if (group) {
    for (var i = 0; i &lt; this.schedules.length; i++) {
      var schedule = this.schedules[i];

      // Validate that the schedule is not in conflict with one of the schedules in the group
      for (var j = 0; j &lt; group.schedules.length; j++) {
        if (this.checkSchedulesConflict(group.schedules[j], schedule))
          return true;
      }

    }
  }

  return false;
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-manage_BrowserPilot.html">manage/BrowserPilot</a></li><li><a href="module-manage_browsersMessages.html">manage/browsersMessages</a></li><li><a href="module-manage_browsersPilotManager.html">manage/browsersPilotManager</a></li><li><a href="module-manage_controllers_BrowserSocketController.html">manage/controllers/BrowserSocketController</a></li><li><a href="module-manage_errors.html">manage/errors</a></li><li><a href="module-manage_manageables_Cache.html">manage/manageables/Cache</a></li><li><a href="module-manage_manageables_Device.html">manage/manageables/Device</a></li><li><a href="module-manage_manageables_Group.html">manage/manageables/Group</a></li><li><a href="module-manage_manageables_Manageable.html">manage/manageables/Manageable</a></li><li><a href="module-manage_ManagePlugin.html">manage/ManagePlugin</a></li><li><a href="module-manage_Manager.html">manage/Manager</a></li><li><a href="module-manage_providers_DeviceProvider.html">manage/providers/DeviceProvider</a></li><li><a href="module-manage_providers_GroupProvider.html">manage/providers/GroupProvider</a></li><li><a href="module-manage_providers_ManageableProvider.html">manage/providers/ManageableProvider</a></li><li><a href="module-manage_ScheduleManager.html">manage/ScheduleManager</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-manage_browsersMessages-BROWSERS_MESSAGES.html">manage/browsersMessages~BROWSERS_MESSAGES</a></li><li><a href="module-manage_errors-ERRORS.html">manage/errors~ERRORS</a></li></ul><h3>Classes</h3><ul><li><a href="module-manage_BrowserPilot-BrowserPilot.html">manage/BrowserPilot~BrowserPilot</a></li><li><a href="module-manage_controllers_BrowserSocketController-BrowserSocketController.html">manage/controllers/BrowserSocketController~BrowserSocketController</a></li><li><a href="module-manage_manageables_Cache-Cache.html">manage/manageables/Cache~Cache</a></li><li><a href="module-manage_manageables_Device-Device.html">manage/manageables/Device~Device</a></li><li><a href="module-manage_manageables_Group-Group.html">manage/manageables/Group~Group</a></li><li><a href="module-manage_manageables_Manageable-Manageable.html">manage/manageables/Manageable~Manageable</a></li><li><a href="module-manage_ManagePlugin-ManagePlugin.html">manage/ManagePlugin~ManagePlugin</a></li><li><a href="module-manage_Manager-Manager.html">manage/Manager~Manager</a></li><li><a href="module-manage_providers_DeviceProvider-DeviceProvider.html">manage/providers/DeviceProvider~DeviceProvider</a></li><li><a href="module-manage_providers_GroupProvider-GroupProvider.html">manage/providers/GroupProvider~GroupProvider</a></li><li><a href="module-manage_providers_ManageableProvider-ManageableProvider.html">manage/providers/ManageableProvider~ManageableProvider</a></li><li><a href="module-manage_ScheduleManager-ScheduleManager.html">manage/ScheduleManager~ScheduleManager</a></li></ul><h3>Events</h3><ul><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:ADD_DEVICE_TO_GROUP">manage/BrowserPilot~BrowserPilot#ADD_DEVICE_TO_GROUP</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:ADD_SCHEDULE">manage/BrowserPilot~BrowserPilot#ADD_SCHEDULE</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:CREATE_GROUP">manage/BrowserPilot~BrowserPilot#CREATE_GROUP</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:ERROR">manage/BrowserPilot~BrowserPilot#ERROR</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:GET_DEVICES">manage/BrowserPilot~BrowserPilot#GET_DEVICES</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:GET_DEVICES_SETTINGS">manage/BrowserPilot~BrowserPilot#GET_DEVICES_SETTINGS</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:GET_GROUPS">manage/BrowserPilot~BrowserPilot#GET_GROUPS</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:INDEX_DEVICE_SESSION">manage/BrowserPilot~BrowserPilot#INDEX_DEVICE_SESSION</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:REMOVE">manage/BrowserPilot~BrowserPilot#REMOVE</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:REMOVE_DEVICE_FROM_GROUP">manage/BrowserPilot~BrowserPilot#REMOVE_DEVICE_FROM_GROUP</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:REMOVE_HISTORIC">manage/BrowserPilot~BrowserPilot#REMOVE_HISTORIC</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:REMOVE_HISTORY">manage/BrowserPilot~BrowserPilot#REMOVE_HISTORY</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:REMOVE_SCHEDULE">manage/BrowserPilot~BrowserPilot#REMOVE_SCHEDULE</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:START_DEVICE_SESSION">manage/BrowserPilot~BrowserPilot#START_DEVICE_SESSION</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:STOP_DEVICE_SESSION">manage/BrowserPilot~BrowserPilot#STOP_DEVICE_SESSION</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:UPDATE_DEVICE_STATE">manage/BrowserPilot~BrowserPilot#UPDATE_DEVICE_STATE</a></li><li><a href="module-manage_BrowserPilot-BrowserPilot.html#event:UPDATE_NAME">manage/BrowserPilot~BrowserPilot#UPDATE_NAME</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Nov 19 2021 16:28:07 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
